<!DOCTYPE html><html><head><meta charSet="utf-8" data-next-head=""/><meta name="viewport" content="width=device-width" data-next-head=""/><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png" data-next-head=""/><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png" data-next-head=""/><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png" data-next-head=""/><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png" data-next-head=""/><link rel="icon" type="image/x-icon" href="/images/favicon.ico" data-next-head=""/><title data-next-head="">Signin and Signup ‚Äì Build a Fullstack Next.js App, v4</title><meta name="description" content="Build a production-ready team wiki from scratch using Next.js, TypeScript, and modern SaaS tools. Master authentication, database integration, AI features, and deployment patterns." data-next-head=""/><meta name="keywords" content="Next.js,fullstack,React,TypeScript,authentication,database,Postgres,Vercel,deployment,SaaS,AI integration,modern web development" data-next-head=""/><meta name="og:description" content="Build a production-ready team wiki from scratch using Next.js, TypeScript, and modern SaaS tools. Master authentication, database integration, AI features, and deployment patterns." data-next-head=""/><meta name="og:title" content="Signin and Signup ‚Äì Build a Fullstack Next.js App, v4" data-next-head=""/><meta name="og:image" content="/images/social-share-cover.jpg" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><link data-next-font="size-adjust" rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/_next/static/css/de2ef606dd4d4a67.css" as="style"/><link rel="stylesheet" href="/_next/static/css/de2ef606dd4d4a67.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-b66ed8ba6f029a99.js" defer=""></script><script src="/_next/static/chunks/framework-b1e5f14688f9ffe6.js" defer=""></script><script src="/_next/static/chunks/main-03ed03852b4b217f.js" defer=""></script><script src="/_next/static/chunks/pages/_app-04cfcdd17f247960.js" defer=""></script><script src="/_next/static/chunks/pages/lessons/%5Bsection%5D/%5Bslug%5D-e3f3acd10ab352ae.js" defer=""></script><script src="/_next/static/3u4FnQFUETt3ux6gefDHe/_buildManifest.js" defer=""></script><script src="/_next/static/3u4FnQFUETt3ux6gefDHe/_ssgManifest.js" defer=""></script></head><body><script async="" defer="" src="https://a.holt.courses/latest.js"></script><div id="__next"><div class="remix-app"><header class="navbar"><h1 class="navbar-brand"><a href="/">Build a Fullstack Next.js App, v4</a></h1><div class="navbar-info"><a href="https://frontendmasters.com/workshops/fullstack-app-next-v4/" class="cta-btn">Watch on Frontend Masters</a></div></header><div class="content-container"><div class="main"><div class="lesson-container"><div class="lesson"><div class="lesson-content"><blockquote>
<p>üö® The version of Neon Auth taught in this course is deprecated. This version of Neon Auth wrapped another service, Stack Auth. Luckily, you can still sign up directly for Stack Auth, but the database sync&#39;ing that it did no longer works. I&#39;ve modified the course notes to use Stack Auth. We will have to add several things that the videos don&#39;t have, but we&#39;ve kept it fairly minimal so that the deviations from the videos is as small as possible. üö®
There is a new version of Neon Auth that uses Better Auth, and you can use that if you please, but it works slightly different and uses a different SDK. But otherwise it&#39;s pretty similar!</p>
</blockquote>
<p>We are going to do now do auth using Neon Auth, which under the hood is the same as Stack Auth - they&#39;re just neatly linked if you use Neon and Neon Auth together.</p>
<blockquote>
<p>We&#39;re going to skip using Neon Auth here and use Stack Auth</p>
</blockquote>
<ul>
<li>Head to Neon.com</li>
<li>Sign up for an account</li>
<li>Create a new project - use the most recent version of Postgres and it doesn&#39;t matter what cloud or region you choose</li>
<li>Click the &quot;Connect&quot; button and copy the connection strings and paste it into a <code>.env</code> file at the root of your project.</li>
</ul>
<blockquote>
<p>Now go to <a href="https://stack-auth.com">stack-auth.com</a>, sign up, and grab the environment keys.</p>
</blockquote>
<ul>
<li>Create a new project on Stack Auth (fem-wikimasters)</li>
<li>Click <code>Project Keys</code> in the sidebar menu</li>
<li>Click <code>Create Project Keys</code> to generate keys for your project</li>
<li>Copy the <code>Next.js</code> keys into your <code>.env</code> file</li>
</ul>
<p>Your new .env file should look like</p>
<pre><code># Stack Auth environment variables for Next.js
NEXT_PUBLIC_STACK_PROJECT_ID=&#x27;your project id&#x27;
NEXT_PUBLIC_STACK_PUBLISHABLE_CLIENT_KEY=&#x27;your publishable key&#x27;
STACK_SECRET_SERVER_KEY=&#x27;your secret key&#x27;

# Neon Database owner connection string
DATABASE_URL=&#x27;your postgres connection string&#x27;
</code></pre><p>Now that we have that (and as a bonus we&#39;re ready to go for our database too because we got the connection string) we can start adding Neon Auth to our project.</p>
<p>Now go to the root of your project and run</p>
<pre><code class="hljs language-bash">npx @stackframe/init-stack@latest --no-browser
</code></pre><p>This should initiate your project and add some auth files to it.</p>
<p>Now you should be able to click sign in or sign up from the top bar and actually sign in or sign up. Stack Auth gives a really nice UI that already fits with shadcn so we don&#39;t need to restyle it or anything (though you certainly could!)</p>
<p>That&#39;s it for intro&#39;ing our sign in and sign out systems. Modern auth companies make this so easy now - it used to be so hard!</p>
<p>So let&#39;s make it that our sign in and sign out buttons show when the user is signed out, and the official UserButton shows from Stack Auth when the user is signed in.</p>
<p>In <code>src/app/components/nav/nav-bar</code> put this</p>
<pre><code class="hljs language-typescript"><span class="hljs-comment">// at top</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">UserButton</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@stackframe/stack&quot;</span>;
<span class="hljs-keyword">import</span> { stackServerApp } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/stack/server&quot;</span>;

<span class="hljs-comment">// inside function</span>
<span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> stackServerApp.<span class="hljs-title function_">getUser</span>();

<span class="hljs-comment">// replace inside menu list</span>
{
  user ? (
    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">NavigationMenuItem</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">UserButton</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">NavigationMenuItem</span>&gt;</span></span>
  ) : (
    <span class="language-xml"><span class="hljs-tag">&lt;&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">NavigationMenuItem</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">asChild</span> <span class="hljs-attr">variant</span>=<span class="hljs-string">&quot;outline&quot;</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/handler/sign-in&quot;</span>&gt;</span>Sign In<span class="hljs-tag">&lt;/<span class="hljs-name">Link</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">NavigationMenuItem</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">NavigationMenuItem</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">asChild</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/handler/sign-up&quot;</span>&gt;</span>Sign Up<span class="hljs-tag">&lt;/<span class="hljs-name">Link</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">NavigationMenuItem</span>&gt;</span>
    <span class="hljs-tag">&lt;/&gt;</span></span>
  )
}
</code></pre><p>Here we&#39;re checking to see if a user exists (which would only exist if they were logged in.) If it exists, show the UserButton from Stack Auth. If not, show our sign in and sign up buttons. Also notice we&#39;re not using the useUser hook - this is a stateful, client-side hook. Because this is a React Server Component, we need to use the server getUser function instead.</p>
<p>Try clicking into the account settings from the UserButton - Stack Auth ships a whole user management system so you don&#39;t have to!</p>
</div><div class="lesson-links"><a href="/lessons/styling/complete-ui" class="prev">‚Üê Previous</a><a href="/lessons/auth/protecting-routes" class="next">Next ‚Üí</a></div></div><div class="details-bg"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="154" height="154" viewBox="0 0 154 154"><defs><clipPath id="clip-path"><rect id="Rectangle_2238" data-name="Rectangle 2238" width="154" height="154" transform="translate(9467 350)" fill="#fff" stroke="#707070" stroke-width="1"></rect></clipPath><clipPath id="clip-corner-image-active"><rect width="154" height="154"></rect></clipPath></defs><g id="corner-image-active" clip-path="url(#clip-corner-image-active)"><g id="Corner-image-active-2" data-name="Corner-image-active" transform="translate(-9467 -350)" clip-path="url(#clip-path)"><path id="Subtraction_34" data-name="Subtraction 34" d="M-3857.365,1740.766h0l-7.07-7.07,12.89-12.89v14.142l-5.818,5.818Zm-14.142-14.142h0l-7.071-7.07,27.033-27.033v14.143l-19.96,19.96Zm-14.143-14.143h0l-7.07-7.069,41.175-41.175v14.142Zm-14.142-14.142h0l-7.07-7.069,55.317-55.317v14.142Zm-14.142-14.142h0l-7.07-7.069,69.459-69.459v14.142Zm-14.142-14.142h0l-7.07-7.069,76.739-76.739h6.862v7.28Zm-14.143-14.143h0l-7.07-7.069,62.6-62.6h14.142Zm-14.142-14.142h0l-7.07-7.069,48.454-48.454h14.142Zm-14.142-14.142h0l-7.07-7.069,34.312-34.312h14.142Zm-14.142-14.142h0l-7.07-7.069,20.17-20.17h14.142Zm-14.142-14.142h0l-7.071-7.071,6.027-6.027h14.144l-13.1,13.1Zm367.24-56.114v-.909l.455.455-.453.453Z" transform="translate(13472.546 -1236.766)" fill="var(--corner-fill)"></path></g></g></svg></div></div></div></div><noscript><img src="https://a.holt.courses/noscript.gif" alt="" referrerPolicy="no-referrer-when-downgrade"/></noscript><footer class="footer"><ul class="socials"><li class="social"><a href="https://twitter.com/holtbt"><svg fill="none" height="100%" width="32" xmlns="http://www.w3.org/2000/svg" viewBox="0.254 0.25 500 451.95400000000006"><path d="M394.033.25h76.67L303.202 191.693l197.052 260.511h-154.29L225.118 294.205 86.844 452.204H10.127l179.16-204.77L.254.25H158.46l109.234 144.417zm-26.908 406.063h42.483L135.377 43.73h-45.59z" fill="var(--footer-icons)"></path></svg></a></li><li class="social"><a href="https://bsky.app/profile/brianholt.me"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -3.268 64 68.414" width="38" height="100%"><path fill="var(--footer-icons)" d="M13.873 3.805C21.21 9.332 29.103 20.537 32 26.55v15.882c0-.338-.13.044-.41.867-1.512 4.456-7.418 21.847-20.923 7.944-7.111-7.32-3.819-14.64 9.125-16.85-7.405 1.264-15.73-.825-18.014-9.015C1.12 23.022 0 8.51 0 6.55 0-3.268 8.579-.182 13.873 3.805zm36.254 0C42.79 9.332 34.897 20.537 32 26.55v15.882c0-.338.13.044.41.867 1.512 4.456 7.418 21.847 20.923 7.944 7.111-7.32 3.819-14.64-9.125-16.85 7.405 1.264 15.73-.825 18.014-9.015C62.88 23.022 64 8.51 64 6.55c0-9.818-8.578-6.732-13.873-2.745z"></path></svg></a></li><li class="social"><a href="https://github.com/btholt"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><defs><clipPath id="clip-github-social"><rect width="32" height="32"></rect></clipPath></defs><g id="github-social" clip-path="url(#clip-github-social)"><g id="Group_272" data-name="Group 272" transform="translate(13522.5 -6994)"><path id="Subtraction_33" data-name="Subtraction 33" d="M-24967.5,8041a15.9,15.9,0,0,1-11.312-4.688A15.893,15.893,0,0,1-24983.5,8025a15.893,15.893,0,0,1,4.689-11.315A15.894,15.894,0,0,1-24967.5,8009a15.894,15.894,0,0,1,11.313,4.686A15.893,15.893,0,0,1-24951.5,8025a15.893,15.893,0,0,1-4.689,11.313A15.9,15.9,0,0,1-24967.5,8041Zm-3.781-4.571h0v3.918h7.895v-6.665a1.836,1.836,0,0,0-1.2-1.718c5.1-.617,7.467-2.975,7.467-7.424a7.176,7.176,0,0,0-1.637-4.728,6.74,6.74,0,0,0,.275-1.812,4.34,4.34,0,0,0-.52-2.452.574.574,0,0,0-.359-.1c-1.061,0-3.465,1.411-3.936,1.694a16.644,16.644,0,0,0-4.2-.489,16.379,16.379,0,0,0-3.969.445c-.846-.5-2.91-1.649-3.859-1.649a.566.566,0,0,0-.354.095,4.3,4.3,0,0,0-.521,2.452,6.7,6.7,0,0,0,.244,1.718,7.346,7.346,0,0,0-1.6,4.822,7.263,7.263,0,0,0,1.533,4.985c1.193,1.359,3.115,2.165,5.871,2.464a1.826,1.826,0,0,0-1.129,1.693v.5h0l-.006,0a7.121,7.121,0,0,1-2.033.363,2.608,2.608,0,0,1-.965-.158,4.438,4.438,0,0,1-1.836-1.881,2.361,2.361,0,0,0-1.248-1.091,3.472,3.472,0,0,0-1.217-.3.584.584,0,0,0-.545.224.282.282,0,0,0,.027.367,1.875,1.875,0,0,0,.447.307,4.732,4.732,0,0,1,.561.355,10.726,10.726,0,0,1,1.682,2.755c.043.092.078.163.105.217a3.876,3.876,0,0,0,2.42,1.185,6.036,6.036,0,0,0,.607.025c.875,0,1.988-.124,2-.125Z" transform="translate(11461 -1015)" fill="var(--footer-icons)"></path><g id="Ellipse_670" data-name="Ellipse 670" transform="translate(-13522.5 6994)" fill="none" stroke="var(--footer-icons)" stroke-width="1"><circle cx="16" cy="16" r="16" stroke="none"></circle><circle cx="16" cy="16" r="15.5" fill="none"></circle></g></g></g></svg></a></li><li class="social"><a href="https://linkedin.com/in/btholt"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><defs><clipPath id="clip-linkedin-social"><rect width="32" height="32"></rect></clipPath></defs><g id="linkedin-social" clip-path="url(#clip-linkedin-social)"><g id="Group_270" data-name="Group 270" transform="translate(-86.349 -633.073)"><path id="Path_375" data-name="Path 375" d="M115.789,633.073a2.324,2.324,0,0,1,1.682.676,2.194,2.194,0,0,1,.695,1.627V662.8a2.131,2.131,0,0,1-.695,1.609,2.314,2.314,0,0,1-1.646.659H88.69a2.307,2.307,0,0,1-1.646-.659,2.128,2.128,0,0,1-.695-1.609V635.376a2.19,2.19,0,0,1,.695-1.627,2.322,2.322,0,0,1,1.682-.676h27.063Zm-20.224,9.672a2.561,2.561,0,0,0,0-3.584,2.658,2.658,0,0,0-1.938-.712,2.724,2.724,0,0,0-1.957.712,2.371,2.371,0,0,0-.75,1.792,2.4,2.4,0,0,0,.731,1.792,2.605,2.605,0,0,0,1.9.713h.037A2.7,2.7,0,0,0,95.565,642.745ZM96,645.434H91.213V659.88H96Zm17.3,6.144a7.007,7.007,0,0,0-1.573-4.9,5.68,5.68,0,0,0-6.839-.769,5.663,5.663,0,0,0-1.426,1.573v-2.048H98.674q.036.841,0,7.717v6.728h4.791V651.8a3.592,3.592,0,0,1,.146-1.17,2.913,2.913,0,0,1,.878-1.206,2.429,2.429,0,0,1,1.609-.549,2.108,2.108,0,0,1,1.865.914,4.265,4.265,0,0,1,.549,2.341v7.752H113.3Z" fill="var(--footer-icons)"></path></g></g></svg></a></li><li class="social"><div class="terms"><p>Content Licensed Under CC-BY-NC-4.0</p><p>Code Samples and Exercises Licensed Under Apache 2.0</p><p>Site Designed by<!-- --> <a href="https://www.alexdanielson.com/">Alex Danielson</a></p></div></li></ul><div class="theme-icons"><link id="highlight-theme-light" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.8.0/styles/a11y-light.min.css"/><link id="highlight-theme-dark" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.8.0/styles/a11y-dark.min.css" disabled=""/><button aria-label="Activate dark mode" title="Activate dark mode" class="theme-toggle"><svg xmlns="http://www.w3.org/2000/svg" width="36px" height="100%" viewBox="0 -960 960 960" fill="var(--text-footer)" role="img"><title>Dark Mode Icon</title><path d="M480-120q-150 0-255-105T120-480q0-150 105-255t255-105q14 0 27.5 1t26.5 3q-41 29-65.5 75.5T444-660q0 90 63 153t153 63q55 0 101-24.5t75-65.5q2 13 3 26.5t1 27.5q0 150-105 255T480-120Zm0-80q88 0 158-48.5T740-375q-20 5-40 8t-40 3q-123 0-209.5-86.5T364-660q0-20 3-40t8-40q-78 32-126.5 102T200-480q0 116 82 198t198 82Z"></path></svg></button></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"attributes":{},"html":"\u003cblockquote\u003e\n\u003cp\u003eüö® The version of Neon Auth taught in this course is deprecated. This version of Neon Auth wrapped another service, Stack Auth. Luckily, you can still sign up directly for Stack Auth, but the database sync\u0026#39;ing that it did no longer works. I\u0026#39;ve modified the course notes to use Stack Auth. We will have to add several things that the videos don\u0026#39;t have, but we\u0026#39;ve kept it fairly minimal so that the deviations from the videos is as small as possible. üö®\nThere is a new version of Neon Auth that uses Better Auth, and you can use that if you please, but it works slightly different and uses a different SDK. But otherwise it\u0026#39;s pretty similar!\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eWe are going to do now do auth using Neon Auth, which under the hood is the same as Stack Auth - they\u0026#39;re just neatly linked if you use Neon and Neon Auth together.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eWe\u0026#39;re going to skip using Neon Auth here and use Stack Auth\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cul\u003e\n\u003cli\u003eHead to Neon.com\u003c/li\u003e\n\u003cli\u003eSign up for an account\u003c/li\u003e\n\u003cli\u003eCreate a new project - use the most recent version of Postgres and it doesn\u0026#39;t matter what cloud or region you choose\u003c/li\u003e\n\u003cli\u003eClick the \u0026quot;Connect\u0026quot; button and copy the connection strings and paste it into a \u003ccode\u003e.env\u003c/code\u003e file at the root of your project.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003eNow go to \u003ca href=\"https://stack-auth.com\"\u003estack-auth.com\u003c/a\u003e, sign up, and grab the environment keys.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cul\u003e\n\u003cli\u003eCreate a new project on Stack Auth (fem-wikimasters)\u003c/li\u003e\n\u003cli\u003eClick \u003ccode\u003eProject Keys\u003c/code\u003e in the sidebar menu\u003c/li\u003e\n\u003cli\u003eClick \u003ccode\u003eCreate Project Keys\u003c/code\u003e to generate keys for your project\u003c/li\u003e\n\u003cli\u003eCopy the \u003ccode\u003eNext.js\u003c/code\u003e keys into your \u003ccode\u003e.env\u003c/code\u003e file\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eYour new .env file should look like\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e# Stack Auth environment variables for Next.js\nNEXT_PUBLIC_STACK_PROJECT_ID=\u0026#x27;your project id\u0026#x27;\nNEXT_PUBLIC_STACK_PUBLISHABLE_CLIENT_KEY=\u0026#x27;your publishable key\u0026#x27;\nSTACK_SECRET_SERVER_KEY=\u0026#x27;your secret key\u0026#x27;\n\n# Neon Database owner connection string\nDATABASE_URL=\u0026#x27;your postgres connection string\u0026#x27;\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eNow that we have that (and as a bonus we\u0026#39;re ready to go for our database too because we got the connection string) we can start adding Neon Auth to our project.\u003c/p\u003e\n\u003cp\u003eNow go to the root of your project and run\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003enpx @stackframe/init-stack@latest --no-browser\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThis should initiate your project and add some auth files to it.\u003c/p\u003e\n\u003cp\u003eNow you should be able to click sign in or sign up from the top bar and actually sign in or sign up. Stack Auth gives a really nice UI that already fits with shadcn so we don\u0026#39;t need to restyle it or anything (though you certainly could!)\u003c/p\u003e\n\u003cp\u003eThat\u0026#39;s it for intro\u0026#39;ing our sign in and sign out systems. Modern auth companies make this so easy now - it used to be so hard!\u003c/p\u003e\n\u003cp\u003eSo let\u0026#39;s make it that our sign in and sign out buttons show when the user is signed out, and the official UserButton shows from Stack Auth when the user is signed in.\u003c/p\u003e\n\u003cp\u003eIn \u003ccode\u003esrc/app/components/nav/nav-bar\u003c/code\u003e put this\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-typescript\"\u003e\u003cspan class=\"hljs-comment\"\u003e// at top\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eUserButton\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;@stackframe/stack\u0026quot;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { stackServerApp } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;@/stack/server\u0026quot;\u003c/span\u003e;\n\n\u003cspan class=\"hljs-comment\"\u003e// inside function\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e user = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e stackServerApp.\u003cspan class=\"hljs-title function_\"\u003egetUser\u003c/span\u003e();\n\n\u003cspan class=\"hljs-comment\"\u003e// replace inside menu list\u003c/span\u003e\n{\n  user ? (\n    \u003cspan class=\"language-xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eNavigationMenuItem\u003c/span\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eUserButton\u003c/span\u003e /\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eNavigationMenuItem\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n  ) : (\n    \u003cspan class=\"language-xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eNavigationMenuItem\u003c/span\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eButton\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003easChild\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003evariant\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;outline\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eLink\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ehref\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;/handler/sign-in\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003eSign In\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eLink\u003c/span\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eButton\u003c/span\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eNavigationMenuItem\u003c/span\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eNavigationMenuItem\u003c/span\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eButton\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003easChild\u003c/span\u003e\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eLink\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ehref\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;/handler/sign-up\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003eSign Up\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eLink\u003c/span\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eButton\u003c/span\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eNavigationMenuItem\u003c/span\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u0026gt;\u003c/span\u003e\u003c/span\u003e\n  )\n}\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eHere we\u0026#39;re checking to see if a user exists (which would only exist if they were logged in.) If it exists, show the UserButton from Stack Auth. If not, show our sign in and sign up buttons. Also notice we\u0026#39;re not using the useUser hook - this is a stateful, client-side hook. Because this is a React Server Component, we need to use the server getUser function instead.\u003c/p\u003e\n\u003cp\u003eTry clicking into the account settings from the UserButton - Stack Auth ships a whole user management system so you don\u0026#39;t have to!\u003c/p\u003e\n","markdown":"\u003e üö® The version of Neon Auth taught in this course is deprecated. This version of Neon Auth wrapped another service, Stack Auth. Luckily, you can still sign up directly for Stack Auth, but the database sync'ing that it did no longer works. I've modified the course notes to use Stack Auth. We will have to add several things that the videos don't have, but we've kept it fairly minimal so that the deviations from the videos is as small as possible. üö®\n\u003e There is a new version of Neon Auth that uses Better Auth, and you can use that if you please, but it works slightly different and uses a different SDK. But otherwise it's pretty similar!\n\nWe are going to do now do auth using Neon Auth, which under the hood is the same as Stack Auth - they're just neatly linked if you use Neon and Neon Auth together.\n\n\u003e We're going to skip using Neon Auth here and use Stack Auth\n\n- Head to Neon.com\n- Sign up for an account\n- Create a new project - use the most recent version of Postgres and it doesn't matter what cloud or region you choose\n- Click the \"Connect\" button and copy the connection strings and paste it into a `.env` file at the root of your project.\n\n\u003e Now go to [stack-auth.com](https://stack-auth.com), sign up, and grab the environment keys.\n\n- Create a new project on Stack Auth (fem-wikimasters)\n- Click `Project Keys` in the sidebar menu\n- Click `Create Project Keys` to generate keys for your project\n- Copy the `Next.js` keys into your `.env` file\n\nYour new .env file should look like\n\n```\n# Stack Auth environment variables for Next.js\nNEXT_PUBLIC_STACK_PROJECT_ID='your project id'\nNEXT_PUBLIC_STACK_PUBLISHABLE_CLIENT_KEY='your publishable key'\nSTACK_SECRET_SERVER_KEY='your secret key'\n\n# Neon Database owner connection string\nDATABASE_URL='your postgres connection string'\n```\n\nNow that we have that (and as a bonus we're ready to go for our database too because we got the connection string) we can start adding Neon Auth to our project.\n\nNow go to the root of your project and run\n\n```bash\nnpx @stackframe/init-stack@latest --no-browser\n```\n\nThis should initiate your project and add some auth files to it.\n\nNow you should be able to click sign in or sign up from the top bar and actually sign in or sign up. Stack Auth gives a really nice UI that already fits with shadcn so we don't need to restyle it or anything (though you certainly could!)\n\nThat's it for intro'ing our sign in and sign out systems. Modern auth companies make this so easy now - it used to be so hard!\n\nSo let's make it that our sign in and sign out buttons show when the user is signed out, and the official UserButton shows from Stack Auth when the user is signed in.\n\nIn `src/app/components/nav/nav-bar` put this\n\n```typescript\n// at top\nimport { UserButton } from \"@stackframe/stack\";\nimport { stackServerApp } from \"@/stack/server\";\n\n// inside function\nconst user = await stackServerApp.getUser();\n\n// replace inside menu list\n{\n  user ? (\n    \u003cNavigationMenuItem\u003e\n      \u003cUserButton /\u003e\n    \u003c/NavigationMenuItem\u003e\n  ) : (\n    \u003c\u003e\n      \u003cNavigationMenuItem\u003e\n        \u003cButton asChild variant=\"outline\"\u003e\n          \u003cLink href=\"/handler/sign-in\"\u003eSign In\u003c/Link\u003e\n        \u003c/Button\u003e\n      \u003c/NavigationMenuItem\u003e\n      \u003cNavigationMenuItem\u003e\n        \u003cButton asChild\u003e\n          \u003cLink href=\"/handler/sign-up\"\u003eSign Up\u003c/Link\u003e\n        \u003c/Button\u003e\n      \u003c/NavigationMenuItem\u003e\n    \u003c/\u003e\n  )\n}\n```\n\nHere we're checking to see if a user exists (which would only exist if they were logged in.) If it exists, show the UserButton from Stack Auth. If not, show our sign in and sign up buttons. Also notice we're not using the useUser hook - this is a stateful, client-side hook. Because this is a React Server Component, we need to use the server getUser function instead.\n\nTry clicking into the account settings from the UserButton - Stack Auth ships a whole user management system so you don't have to!\n","slug":"signin-and-signup","title":"Signin and Signup","section":"Auth","icon":"user-lock","filePath":"/home/runner/work/build-a-fullstack-nextjs-app-v4/build-a-fullstack-nextjs-app-v4/lessons/03-auth/A-signin-and-signup.md","nextSlug":"/lessons/auth/protecting-routes","prevSlug":"/lessons/styling/complete-ui"}},"__N_SSG":true},"page":"/lessons/[section]/[slug]","query":{"section":"auth","slug":"signin-and-signup"},"buildId":"3u4FnQFUETt3ux6gefDHe","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>